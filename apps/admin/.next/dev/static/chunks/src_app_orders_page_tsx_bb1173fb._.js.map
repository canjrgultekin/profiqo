{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/source/canjrgultekin/profiqo/apps/admin/src/app/orders/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\n\r\ntype OrderRow = {\r\n  orderId: string;\r\n  customerId: string;\r\n  channel: string;\r\n  status: string;\r\n  providerOrderId: string | null;\r\n  placedAtUtc: string;\r\n  totalAmount: number;\r\n  totalCurrency: string;\r\n  netProfit: number;\r\n  netProfitCurrency: string;\r\n  lineCount: number;\r\n};\r\n\r\ntype OrdersResponse = {\r\n  page: number;\r\n  pageSize: number;\r\n  total: number;\r\n  items: OrderRow[];\r\n};\r\n\r\nexport default function OrdersPage() {\r\n  const [q, setQ] = useState(\"\");\r\n  const [page, setPage] = useState(1);\r\n  const pageSize = 25;\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [err, setErr] = useState<string | null>(null);\r\n  const [data, setData] = useState<OrdersResponse | null>(null);\r\n\r\n  const totalPages = useMemo(() => {\r\n    if (!data) return 1;\r\n    return Math.max(1, Math.ceil(data.total / data.pageSize));\r\n  }, [data]);\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    setErr(null);\r\n\r\n    const qs = new URLSearchParams({ page: String(page), pageSize: String(pageSize) });\r\n    if (q.trim()) qs.set(\"q\", q.trim());\r\n\r\n    try {\r\n      const res = await fetch(`/api/orders?${qs.toString()}`, { method: \"GET\", cache: \"no-store\" });\r\n      const payload = await res.json().catch(() => null);\r\n\r\n      if (!res.ok) {\r\n        setErr(payload?.message || \"Orders load failed.\");\r\n        setData(null);\r\n        return;\r\n      }\r\n\r\n      setData(payload);\r\n    } catch {\r\n      setErr(\"Orders load failed (network).\");\r\n      setData(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { load(); }, [page]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  return (\r\n    <div className=\"p-4 sm:p-6\">\r\n      <div className=\"mb-4 flex flex-wrap items-end gap-3\">\r\n        <div className=\"flex flex-col\">\r\n          <label className=\"text-sm text-body-color dark:text-dark-6\">Search</label>\r\n          <input\r\n            className=\"w-[320px] rounded-lg border border-stroke bg-transparent px-4 py-2 text-dark outline-none focus:border-primary dark:border-dark-3 dark:text-white\"\r\n            value={q}\r\n            onChange={(e) => setQ(e.target.value)}\r\n            placeholder=\"Provider order id\"\r\n          />\r\n        </div>\r\n\r\n        <button\r\n          onClick={() => { setPage(1); load(); }}\r\n          className=\"rounded-lg bg-primary px-4 py-2 font-medium text-white hover:bg-opacity-90 disabled:opacity-60\"\r\n          disabled={loading}\r\n        >\r\n          Search\r\n        </button>\r\n      </div>\r\n\r\n      {err && (\r\n        <div className=\"mb-4 rounded-lg border border-red-500/30 bg-red-500/10 px-4 py-3 text-sm text-red-600 dark:text-red-400\">\r\n          {err}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"rounded-[10px] bg-white p-4 shadow-1 dark:bg-gray-dark dark:shadow-card\">\r\n        <div className=\"mb-3 flex items-center justify-between\">\r\n          <h2 className=\"text-lg font-semibold text-dark dark:text-white\">Orders</h2>\r\n          <div className=\"text-sm text-body-color dark:text-dark-6\">{data ? `${data.total} total` : \"\"}</div>\r\n        </div>\r\n\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full table-auto\">\r\n            <thead>\r\n              <tr className=\"text-left text-sm text-body-color dark:text-dark-6\">\r\n                <th className=\"px-3 py-2\">Order</th>\r\n                <th className=\"px-3 py-2\">Channel</th>\r\n                <th className=\"px-3 py-2\">Status</th>\r\n                <th className=\"px-3 py-2\">Total</th>\r\n                <th className=\"px-3 py-2\">Placed</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading && <tr><td className=\"px-3 py-3 text-sm\" colSpan={5}>Loading...</td></tr>}\r\n\r\n              {!loading && data?.items?.length ? (\r\n                data.items.map((x) => (\r\n                  <tr key={x.orderId} className=\"border-t border-stroke dark:border-dark-3\">\r\n                    <td className=\"px-3 py-3 text-sm text-dark dark:text-white\">\r\n                      <a className=\"underline\" href={`/orders/${x.orderId}`}>\r\n                        {x.providerOrderId || x.orderId}\r\n                      </a>\r\n                    </td>\r\n                    <td className=\"px-3 py-3 text-sm\">{x.channel}</td>\r\n                    <td className=\"px-3 py-3 text-sm\">{x.status}</td>\r\n                    <td className=\"px-3 py-3 text-sm\">{x.totalAmount} {x.totalCurrency}</td>\r\n                    <td className=\"px-3 py-3 text-sm\">{new Date(x.placedAtUtc).toLocaleString()}</td>\r\n                  </tr>\r\n                ))\r\n              ) : (\r\n                !loading && <tr><td className=\"px-3 py-3 text-sm\" colSpan={5}>No orders.</td></tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        <div className=\"mt-4 flex items-center justify-between\">\r\n          <button className=\"rounded-lg border border-stroke px-3 py-2 text-sm dark:border-dark-3\"\r\n            onClick={() => setPage((p) => Math.max(1, p - 1))}\r\n            disabled={loading || page <= 1}>\r\n            Prev\r\n          </button>\r\n\r\n          <div className=\"text-sm text-body-color dark:text-dark-6\">\r\n            Page {page} / {totalPages}\r\n          </div>\r\n\r\n          <button className=\"rounded-lg border border-stroke px-3 py-2 text-sm dark:border-dark-3\"\r\n            onClick={() => setPage((p) => Math.min(totalPages, p + 1))}\r\n            disabled={loading || page >= totalPages}>\r\n            Next\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}